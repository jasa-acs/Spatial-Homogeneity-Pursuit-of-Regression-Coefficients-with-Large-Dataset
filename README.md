# Spatial-Homogeneity-Pursuit-of-Regression-Coefficients-with-Large-Dataset

# Author Contributions Checklist Form

## Data

### Abstract 

This document describes the availability of data used in this manuscript, including the synthetic data for the simulation studies and temperature and salinity records obtained from the World Atlas 2013 version 2 (WOA 13 V2) for the real data application. The URLs for temperature and salinity dataset are:

* [Temperature](https://data.nodc.noaa.gov/thredds/catalog/woa/WOA13/DATAv2/temperature/netcdf/decav/0.25/catalog.html?dataset=woa/WOA13/DATAv2/temperature/netcdf/decav/0.25/woa13_decav_t00_04v2.nc)

* [Salinity](https://data.nodc.noaa.gov/thredds/catalog/woa/WOA13/DATAv2/salinity/netcdf/decav/0.25/catalog.html?dataset=woa/WOA13/DATAv2/salinity/netcdf/decav/0.25/woa13_decav_s00_04v2.nc)

### Availability 

All data are open to the public and can be downloaded from a GitHub repository ([here](https://github.com/furong-tamu/Supplementary-files-for-SCC)). 

### Description

The synthetic data are completely generated by the authors of this manuscript. The World Atlas 2013 version 2 dataset is free to use for noncommercial purposes with proper acknowledgments. Both the simulation and real datasets are stored as the Matlab data format (.mat) or netcdf data format (.nc).

## Code

### Abstract

This document describes the availability of codes to perform the SCC analysis and reproduce the numerical studies in the manuscript.

### Description 

The SCC code is delivered as a Matlab package. The SCC package is built on the Matlab package glmnet (the version updated on Aug 30, 2013). The R code to run a competing method, generalized lasso regression, is also included.

All code is open to the public and can be downloaded from a Github repository ([here](https://github.com/furong-tamu/Supplementary-files-for-SCC)).

### Optional Information

* **Hardware requirements:** The codes can be run on both PC and Mac.
* **Supporting software requirements:** Matlab verison 2013b or later and R version 3.3.3 or later are required to run the codes.

### Reproducibility 

The repository includes the codes, data files and instructions to reproduce Figures 2-7 and Tables 1-3 in the manuscript. Some important notes are as follows:

1. To run the codes, please first install the following packages: glmnet package for Matlab to perform [lasso](https://web.stanford.edu/~hastie/glmnet_matlab/download.html), jplv7 package for Matlab to perform [GWR](http://www.spatial-econometrics.com), RNetCDF package (1.9-1) for R to handle data files in netcdf format, spgwr package (0.6-32) for R to perform GWR, glmnet package (2.0-13) for R to perform lasso, devtools package (1.13- 4) for R to download penreg package (1.0) that solves the generalized lasso package, and R.matlab package (3.61) to read data stored in the matlab data format (.mat).

2. The master Matlab script run_SCC.m can be used to reproduce the figures and tables in the manuscript. Detailed instructions are included in run_SCC.m.

3. Reproducing Figure 3 requires solving the generalized lasso, which may take days to run.

4. The SCC package is built on the Matlab package glmnet. The results shown in the manuscript are derived using the glmnet version updated on Aug 30, 2013.

### Replication 

Instruction on using the SCC code in other settings can be found from the code documentation sections.
